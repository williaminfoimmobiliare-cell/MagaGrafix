<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MagaGrafix ‚Äî Modalit√† Scanner</title>
  <link rel="stylesheet" href="style.css?v=5" />
  <style>
    /* Ritocchi dedicati alla pagina scanner */
    .scanner-wrap{max-width:900px;margin:20px auto}
    .big-input{font-size:1.4rem;padding:14px 16px}
    .pill{display:inline-block;padding:6px 10px;border-radius:999px;border:1px solid var(--border);color:var(--muted);text-decoration:none}
    .btn-big{font-size:1.05rem;padding:12px 18px}
    .grid-sc{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:768px){.grid-sc{grid-template-columns:1fr}}
    .lastbox{background:linear-gradient(180deg,var(--card),var(--card-2));border:1px solid var(--border);border-radius:12px;padding:12px}
    .ok{color:#10b981}.err{color:#ef4444}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .small{opacity:.9}
  </style>
</head>
<body>
  <div class="wrap scanner-wrap">
    <header style="text-align:center">
      <h1>MagaGrafix ‚Äî Scanner</h1>
      <div id="syncStatus" class="sync-badge">Sync: ‚Äî</div>
      <div style="margin-top:8px">
        <a class="pill" href="./index.html">‚üµ Torna al gestionale</a>
      </div>
    </header>

    <!-- üîπ Sezione: Scanner fotocamera (beta) -->
    <div class="card">
      <h3>Scanner fotocamera (beta)</h3>
      <div class="row">
        <button id="camStart">üé• Avvia fotocamera</button>
        <button id="camStop" class="ghost">‚ñ† Stop</button>
        <span class="small" id="camStatus">‚Äî</span>
      </div>
      <div id="camBox" class="chartwrap" style="margin-top:10px; display:none;">
        <video id="cam" playsinline autoplay style="width:100%;max-height:260px;border-radius:8px;"></video>
      </div>
      <div class="small" style="margin-top:6px">
        Suggerimento: funziona su Chrome/Android. Su iPhone/Safari il supporto pu√≤ mancare.
      </div>
    </div>

    <!-- üîπ Sezione: Scanner hardware (lettore barcode USB/Bluetooth = tastiera) -->
    <div class="card">
      <h3>Scanner hardware / inserimento rapido</h3>
      <div class="flexcol">
        <input id="scanInput" class="big-input" placeholder="Metti il cursore qui e SCANNA il codice a barre‚Ä¶" autofocus />
        <div class="row">
          <div class="grid-sc">
            <div class="flexcol">
              <label>Tipo</label>
              <div class="row">
                <button class="btn-big" data-type="IN" id="btnTypeIN">1Ô∏è‚É£ IN (entrata)</button>
                <button class="btn-big" data-type="OUT" id="btnTypeOUT">2Ô∏è‚É£ OUT (vendita)</button>
                <button class="btn-big" data-type="ROTTURA" id="btnTypeROTTURA">3Ô∏è‚É£ ROTTURA</button>
              </div>
            </div>
            <div class="flexcol">
              <label>Quantit√†</label>
              <div class="row">
                <button id="qtyMinus" class="ghost btn-big">‚àí</button>
                <input id="qty" type="number" min="1" value="1" style="max-width:120px;text-align:center" />
                <button id="qtyPlus" class="ghost btn-big">Ôºã</button>
              </div>
            </div>
          </div>

          <div class="row" style="margin-top:8px">
            <input id="price" type="number" step="0.01" placeholder="Prezzo (solo OUT)" />
            <label class="switch" title="Conferma automatica alla scansione">
              <input id="autoConfirm" type="checkbox"><span>Auto-conferma</span>
            </label>
            <label class="switch" title="Suoni">
              <input id="soundToggle" type="checkbox" checked><span>Suono</span>
            </label>
            <button id="confirmBtn" class="btn-big">‚úÖ Conferma (Invio)</button>
            <button id="syncBtn" class="ghost">üîÑ Sincronizza ora</button>
          </div>
        </div>
      </div>
    </div>

    <!-- üîπ Ultimo risultato -->
    <div class="card lastbox">
      <h3>Ultimo risultato</h3>
      <div id="lastMsg" class="small">‚Äî</div>
    </div>

    <!-- üîπ Associazione barcode ‚Üî SKU -->
    <div class="card">
      <h3>Associa barcode a SKU (se non trovato)</h3>
      <div class="row">
        <input id="unknownBarcode" placeholder="Barcode letto (solo lettura)" readonly />
        <input id="assignSku" placeholder="SKU esistente o nuovo" />
        <button id="assignBtn">üîó Associa</button>
      </div>
      <div class="small">Se lo SKU esiste gi√†, collegher√† il barcode all‚Äôarticolo. Se non esiste, crea un nuovo articolo con stock 0.</div>
    </div>

    <footer class="small" style="text-align:center">¬© 2025 MagaGrafix ‚Äî Modalit√† Scanner veloce</footer>
  </div>

  <!-- JS della pagina scanner -->
  <script src="scan.js?v=3"></script>
</body>
</html>
